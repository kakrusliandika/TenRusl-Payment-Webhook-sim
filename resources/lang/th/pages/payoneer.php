<?php

return [

    'hint' => 'การแจ้งเตือนแบบเฉพาะผลิตภัณฑ์.',

    'summary' => <<<'TEXT'
Payoneer Checkout ส่งการแจ้งเตือนแบบอะซิงโครนัส (webhooks) ไปยังเอ็นด์พอยต์ที่คุณควบคุม เพื่อให้ระบบของคุณสามารถกระทบยอดสถานะการชำระเงินได้อย่างปลอดภัยนอกเบราว์เซอร์ของผู้ใช้ แพลตฟอร์มให้คุณกำหนด notification URL เฉพาะ และเลือกสไตล์การส่งที่เหมาะกับสแตกของคุณ—POST (แนะนำ) หรือ GET โดยรองรับ JSON หรือพารามิเตอร์แบบ form-encoded เนื่องจากชุดพารามิเตอร์และรูปแบบการลงนาม/ยืนยันตัวตนแตกต่างกันตามผลิตภัณฑ์ ให้มองการแจ้งเตือนของ Payoneer เป็น “พื้นผิวการอินทิเกรต”: บันทึกเอกสารหัวข้อ/ฟิลด์ที่ใช้ระบุอีเวนต์ ใส่เมทาดาทาป้องกัน replay เมื่อมีให้ และตรวจสอบความถูกต้องก่อนที่จะเปลี่ยนแปลงสถานะใด ๆ

ในเชิงปฏิบัติการ ให้เริ่มจากแฮนด์เลอร์ที่แคบและเป็นแบบ idempotent โดยบันทึกเรคคอร์ดอีเวนต์ที่เปลี่ยนแปลงไม่ได้ (immutable) และตอบกลับ 2xx ให้เร็ว เก็บตรรกะธุรกิจที่หนักไว้ที่แบ็กกราวด์เวิร์กเกอร์เพื่อหลีกเลี่ยง retry storm ใช้คีย์สำหรับ dedup และบังคับใช้หน้าต่างความสดใหม่ (freshness window) กับ timestamp/nonce (ถ้ามี) เพื่อป้องกัน replay หรือการส่งไม่เรียงลำดับ หากต้องการความมั่นใจเพิ่ม ให้แนบโทเคนที่ผู้ให้บริการออกให้ (หรือซีเคร็ตสุ่มของคุณเอง) ใน notification URL แล้วตรวจสอบฝั่งเซิร์ฟเวอร์ สุดท้าย จัดทำ runbook ให้ทีม ระบุเอ็นด์พอยต์ รูปแบบ รหัสความล้มเหลว และขั้นตอนการตรวจสอบที่แน่นอนสำหรับผลิตภัณฑ์ Payoneer ที่คุณใช้งาน—และเวอร์ชันควบคู่ไปกับโค้ด
TEXT
    ,

    // Dari view Payoneer
    'docs' => 'https://checkoutdocs.payoneer.com/docs/create-notification-endpoints',

    'signature_notes' => [
        'เปิดเอ็นด์พอยต์แจ้งเตือนเฉพาะ (แนะนำ POST); รองรับ JSON หรือฟอร์มดาต้า.',
        'ตรวจสอบความถูกต้องตามที่เอกสารของผลิตภัณฑ์ย่อยระบุ (โทเคนหรือฟิลด์ลายเซ็น); ไม่ตรงให้ปฏิเสธ.',
        'บังคับใช้ความสดใหม่ของ timestamp/nonce เมื่อมี และทำให้การประมวลผลเป็นแบบ idempotent (เก็บ dedup key).',
        'ACK เร็ว (2xx) และย้ายงานหนักไปแบ็กกราวด์จ็อบ; เก็บบันทึกตรวจสอบโดยไม่ล็อกซีเคร็ต.',
    ],

    'example_payload' => [
        'event'     => 'checkout.transaction.completed',
        'provider'  => 'payoneer',
        'data'      => [
            'orderId'  => 'PO-001',
            'amount'   => 25000,
            'currency' => 'IDR',
            'status'   => 'COMPLETED',
        ],
        'sent_at'   => now()->toIso8601String(),
    ],

    'endpoints' => [
        [
            'method' => 'POST',
            'path'   => '/api/payments',
            'desc'   => __('pages.create_payment'),
        ],
        [
            'method' => 'GET',
            'path'   => '/api/payments/{id}',
            'desc'   => __('pages.get_payment'),
        ],
        [
            'method' => 'POST',
            'path'   => '/api/webhooks/payoneer',
            'desc'   => __('pages.receive_webhook'),
        ],
    ],
];
